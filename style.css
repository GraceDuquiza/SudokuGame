/* ==========================================================
    RESET + BASE THEME
    - Normalize layout & define a color system
   ========================================================== */
* { box-sizing: border-box; }

html, body {
    margin: 0;
    padding: 0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    -webkit-tap-highlight-color: transparent; /* removes tap flash on mobile */
}

/* Theme colors + a single source of truth for cell font size */
:root {
  --bg: #0f172a;        /* dark background */
  --card: #111827;      /* card panels (sidebar, toolbar) */
  --muted: #94a3b8;     /* muted/secondary text */
  --text: #f1f5f9;      /* main text */
  --accent: #22c55e;    /* green = confirm, main action */
  --accent-2: #60a5fa;  /* blue = toggle/selected */
  --danger: #ef4444;    /* red = errors/mistakes */
  --hint: #ffcc00;      /* yellow = hints */

  /* âœ… One font-size used by BOTH 4Ã—4 and 9Ã—9 numbers */
    --cell-font: clamp(1.05rem, 2.6vw, 1.6rem);

  /* âœ… GAME FONT (grid + numpad): Cambria Math with safe fallbacks */
  --game-font: "Cambria Math", Cambria, "Times New Roman", serif; /* <-- NEW */
}

@media (max-width: 600px) {
  /* Slightly different scaling on small phones, still UNIFORM for 4Ã—4 & 9Ã—9 */
    :root { --cell-font: clamp(1rem, 5.5vw, 1.45rem); }
}

body {
    background: linear-gradient(180deg, #0b1222, var(--bg));
    color: var(--text);
    min-height: 100dvh;
}

/* ==========================================================
    HEADER
   ========================================================== */
.app-header { text-align: center; padding: 16px; }
.app-header h1 { margin: 0 0 4px; font-weight: 800; font-size: 1.5rem; }
.subtitle { margin: 0; color: var(--muted); font-size: 0.9rem; }

/* ==========================================================
    LAYOUT (2 columns â†’ 1 column on mobile)
   ========================================================== */
.app {
    display: grid;
    grid-template-columns: 1fr 320px;
    gap: 16px;
    padding: 12px;
    max-width: 1200px;
    margin: 0 auto;
}
@media (max-width: 768px) {
    .app { grid-template-columns: 1fr; }
    .right { order: -1; } /* sidebar above board on mobile */
}

/* ==========================================================
    CARDS + TOOLBAR CONTROLS
   ========================================================== */
.card {
    background: var(--card);
    border: 1px solid #334155;
    border-radius: 12px;
    padding: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.25);
}
.toolbar .row {
    display: flex;
    gap: 8px;
    align-items: center;
    margin-bottom: 8px;
    flex-wrap: wrap;
}
.toolbar label { color: var(--muted); }

select, button {
    background: #0b1020;
    color: var(--text);
    border: 1px solid #334155;
    border-radius: 10px;
    padding: 10px 14px;
    font-size: 1rem;
    cursor: pointer;
}
button.primary {
    background: var(--accent);
    color: #0b1020;
    border-color: transparent;
    font-weight: 700;
}
button.primary:hover { filter: brightness(1.1); }
button.toggly[aria-pressed="true"] {
    background: var(--accent-2);
    color: #0b1020;
    font-weight: 700;
}
button:disabled { opacity: 0.55; cursor: not-allowed; }
button.danger {
    background: var(--danger);
    border-color: transparent;
    color: white;
}
button.danger:hover { filter: brightness(1.1); }

/* ==========================================================
    iOS-STYLE TOGGLE SWITCH
   ========================================================== */
.switch { position: relative; display: inline-block; width: 44px; height: 26px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider {
    position: absolute; inset: 0; cursor: pointer;
    background-color: #243046; border: 1px solid #334155;
    transition: .2s; border-radius: 26px;
}
.slider:before {
    content: ""; position: absolute; left: 2px; bottom: 2px;
    height: 20px; width: 20px; background: #fff; border-radius: 50%;
    transition: .2s;
}
.switch input:checked + .slider { background-color: var(--accent-2); }
.switch input:checked + .slider:before { transform: translateX(18px); }

/* ==========================================================
    SUDOKU BOARD
    - Equal column math via table-layout: fixed
    - The square aspect lives on .cell-inner
   ========================================================== */
table.sudoku {
    width: 100%;
    max-width: 500px;                 /* default board width (9Ã—9) */
    margin: 10px auto;
    border-collapse: collapse;
    background: #fff;
    border: 6px solid #000;
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    table-layout: fixed;              /* lock columns */
}
@media (max-width: 600px) { table.sudoku { max-width: 100%; } }

/* Each grid cell container (no aspect-ratio here) */
.sudoku td.cell {
    position: relative;
    text-align: center;
    vertical-align: middle;
    border: 1px solid #ccc;
    user-select: none;
    padding: 0;
}

/* The square, centered number */
.sudoku td.cell .cell-inner {
    width: 100%;
    aspect-ratio: 1 / 1;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: var(--cell-font);           /* UNIFORM number size */
    font-family: var(--game-font);         /* âœ… GAME FONT applied */
    color: #000;
    background: #fff;
}

/* ==========================================================
   CELL STATES (apply color to the *box*, not just borders)
   ========================================================== */
.sudoku td.prefilled .cell-inner { background: #f0f0f0; }  /* given clues */
.sudoku td.selected  .cell-inner { background: #d2e4f6; }  /* current cell */
.sudoku td.conflict  .cell-inner { background: #f59292; }  /* conflicting */

/* ðŸ”µ Same-number highlight (clear, not too dark) */
.sudoku td.sameNumber .cell-inner { background: #5da7f6; }

/* ðŸ”´ Mistake styling: light red fill + keep red border/text */
.sudoku td.mistakeNumber .cell-inner { background: #f69292; }
.sudoku td.mistakeNumber {
    color: red !important;
    border: 2px solid #ff0000;
}

/* Heavy borders for sub-boxes stay on the td */
.sudoku td.box-right  { border-right: 3px solid #000 !important; }
.sudoku td.box-bottom { border-bottom: 3px solid #000 !important; }

/* ==========================================================
    NOTES OVERLAY (tiny pencil marks)
   ========================================================== */
.notes {
    position: absolute; inset: 3px;
    display: grid; grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    font-size: 0.7rem; color: #444;
    font-family: var(--game-font);         /* âœ… GAME FONT on notes too */
}
.notes.small { grid-template-columns: repeat(2, 1fr); grid-template-rows: repeat(2, 1fr); }
.note { display: flex; justify-content: center; align-items: center; }

/* ==========================================================
    NUMPAD â€” horizontal rail with digit + remaining counter
   ========================================================== */
.numpad { display: flex; justify-content: center; }

/* Single row, never wraps; scrolls horizontally on small screens */
.numpad .keys {
    display: flex;
    gap: 12px;
    justify-content: center;
    align-items: center;
    flex-wrap: nowrap;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    padding: 6px 8px;
    width: 100%;
    max-width: 100%;
}
.numpad .keys::-webkit-scrollbar { height: 8px; }
.numpad .keys::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
.numpad .keys { scrollbar-color: #334155 transparent; scrollbar-width: thin; }

/* Buttons show two lines: .digit (big) + .remain (small) */
.numpad button {
    display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 2px;
    flex: 0 0 auto;                     /* donâ€™t shrink; keep width */
    font-size: 1.2rem; font-weight: 800;
    padding: 16px 0; min-width: 64px;
    background: #fff; color: #000;
    border: 2px solid #000; border-radius: 8px;
    box-shadow: 2px 2px 0 #555;
    transition: transform .06s ease, box-shadow .06s ease, background .12s ease, opacity .12s ease;
    font-family: var(--game-font);       /* âœ… GAME FONT on whole button */
}
.numpad button:hover { background: #f5f5f5; }

/* Large digit (top) + remaining count (bottom) */
.numpad .digit  { font-size: 1.9rem; line-height: 1; font-weight: 800; color: #1f59d1; font-family: var(--game-font); } /* âœ… */
.numpad .remain { font-size: 0.80rem; line-height: 2; color: #374151; opacity: 0.9; font-family: var(--game-font); }  /* âœ… */

/* Active/exhausted states */
.numpad button.active    { background: #cfe1ff; border-color: #1f2937; box-shadow: 2px 2px 0 #1f2937; }
.numpad button.exhausted { opacity: 0.45; }
.numpad button.exhausted .digit,
.numpad button.exhausted .remain { color: #6b7280; }

/* Small-phone tweaks */
@media (max-width: 360px) {
    .numpad .digit { font-size: 1.6rem; }
    .numpad .remain { font-size: 0.9rem; }
    .numpad button { min-width: 56px; padding: 14px 0; }
}

/* ==========================================================
    FOOTER / SIDEBAR (Coach / Status / Tips)
   ========================================================== */
.coach h2, .status h2, .tips h2 { margin: 6px 0 10px; font-size: 1.1rem; }
.stats { display: grid; gap: 6px; font-size: 1rem; }
.stats div { display: flex; justify-content: space-between; color: var(--muted); }
.app-footer { text-align: center; padding: 8px 12px 24px; color: var(--muted); font-size: 0.85rem; }

/* ==========================================================
    MISTAKES (shake animation kept)
   ========================================================== */
@keyframes shake {
    0% { transform: translateX(0px); }
    25% { transform: translateX(-4px); }
    50% { transform: translateX(4px); }
    75% { transform: translateX(-4px); }
    100% { transform: translateX(0px); }
}

/* ==========================================================
    GAME OVER / WIN OVERLAY
   ========================================================== */
.game-over {
    position: fixed; inset: 0; background: rgba(0,0,0,0.85);
    display: flex; align-items: center; justify-content: center;
    z-index: 1000; padding: 20px;
}
.game-over .overlay-box {
    background: #1e293b; border-radius: 16px; padding: 40px 30px;
    max-width: 460px; width: 100%; text-align: center;
    box-shadow: 0 6px 22px rgba(0,0,0,0.55); animation: popIn 0.4s ease;
}
@keyframes popIn {
    from { transform: scale(0.85); opacity: 0; }
    to   { transform: scale(1); opacity: 1; }
}
.game-over h2 { margin: 0 0 24px; font-size: 2.4rem; font-weight: 800; color: var(--accent); }
.game-over p  { margin: 12px 0; font-size: 1.3rem; color: var(--text); }
.game-over strong { color: var(--hint); font-size: 1.6rem; }
.game-over .buttons { margin-top: 32px; display: flex; justify-content: center; gap: 20px; }
.game-over button { padding: 14px 28px; font-size: 1.1rem; font-weight: 700; border-radius: 10px; cursor: pointer; border: none; min-width: 140px; }
.game-over button#nextChallenge { background: var(--accent); color: #0b1020; }
.game-over button#quitGame     { background: var(--danger); color: #fff; }
.game-over button:hover        { filter: brightness(1.1); }

/* ==========================================================
    HINT HIGHLIGHT (pulsing yellow)
   ========================================================== */
.sudoku td.hint-highlight .cell-inner { background: #fff3b0 !important; }
.sudoku td.hint-highlight {
    outline: 3px solid var(--hint);
    animation: pulse 0.8s ease-in-out infinite alternate;
}
@keyframes pulse {
    from { transform: scale(1); }
    to   { transform: scale(1.05); }
}

/* ==========================================================
    BOARD SIZE TWEAKS FOR 4Ã—4
    - Only width; NO font-size override so digits stay UNIFORM
========================================================== */
table.sudoku[data-n="4"] { max-width: 320px; }
@media (max-width: 600px) { table.sudoku[data-n="4"] { max-width: 260px; } }
